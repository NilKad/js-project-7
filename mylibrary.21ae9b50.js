!function(){var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},a={},n=e.parcelRequire6149;null==n&&((n=function(e){if(e in t)return t[e].exports;if(e in a){var n=a[e];delete a[e];var o={id:e,exports:{}};return t[e]=o,n.call(o.exports,o,o.exports),o.exports}var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){a[e]=t},e.parcelRequire6149=n);var o=n("aTzrc"),i=n("g2YN6"),r=n("6fJbC");n("1VFfL");var c,l,s=n("6Urw1"),d=n("6Nu6u"),u=n("3SEMc"),g=(0,s.initializeApp)({apiKey:"AIzaSyCI5JTbKtHIHNuS4WcbgMfz2S8WxJp_ehM",authDomain:"filmoteka-proj-7.firebaseapp.com",databaseURL:"https://filmoteka-proj-7-default-rtdb.europe-west1.firebasedatabase.app/",projectId:"filmoteka-proj-7",storageBucket:"filmoteka-proj-7.appspot.com",messagingSenderId:"181528100082",appId:"1:181528100082:web:031dd9add36023a4e5e46b",measurementId:"G-1X27T2N03L"}),m=((0,d.getDatabase)(g),(0,d.ref)((0,d.getDatabase)())),v=(0,u.getAuth)(),f=[],h=[],p="",L=document.querySelector(".logout"),b=document.querySelector(".welcome-ml");(0,u.onAuthStateChanged)(v,(function(e){e?(c=e.uid,l=e.email,console.log("Это обсервер my-library"),L.classList.remove("visually-hidden"),b.innerHTML="Welcome, ".concat(l,"!")):L.classList.add("visually-hidden")}));var w,S=document.querySelector(".movies"),y=document.querySelector('[data-id="watched-btn"'),k=document.querySelector('[data-id="queue-btn"'),E=(document.querySelector(".header-nav__link--current-header"),new(0,r.localStorageAPI));function M(e){var t=e.target.closest("li").dataset.id;if("UL"!==e.target.nodeName)try{var a,n=E.getData("watched"),o=E.getData("genresList"),r=n.filter((function(e){return e.id===Number(t)}))[0],c=r.genre_ids;c&&(a=o.filter((function(e){var t=e.id;return c.includes(t)})).map((function(e){return e.name}))),r.genres=a,E.setData("current-film",r),(0,i.modalBasicLightbox)(r,"watched"),E.addListenersToBtns()}catch(e){console.log(e.message)}}function T(e){var t=e.target.closest("li").dataset.id;if("UL"!==e.target.nodeName)try{var a,n=E.getData("queue"),o=E.getData("genresList"),r=n.filter((function(e){return e.id===Number(t)}))[0],c=r.genre_ids;c&&(a=o.filter((function(e){var t=e.id;return c.includes(t)})).map((function(e){return e.name}))),r.genres=a,E.setData("current-film",r),(0,i.modalBasicLightbox)(r,"queue"),E.addListenersToBtns()}catch(e){console.log(e.message)}}y.addEventListener("click",(function(){if(S.removeEventListener("click",T),y.classList.contains("is-active"))return;(0,u.onAuthStateChanged)(v,(function(e){e?(c=e.uid,l=e.email,(0,d.get)((0,d.child)(m,"users/".concat(c,"watched/watched"))).then((function(e){e.exists()?(f=e.val(),console.log("getWatched",e.val()),p=(0,o.createMovieCards)(f),S.innerHTML=p,S.addEventListener("click",M)):(console.log("No data available"),f=e.val(),console.log("getWatched",e.val()),p="<div><p>ЗАГЛУШКА Watched</p></div>",S.innerHTML=p,S.addEventListener("click",M))})).catch((function(e){console.error(e)}))):(f=E.getData("watched"),p=(0,o.createMovieCards)(f),S.innerHTML=p,S.addEventListener("click",M))}))})),k.addEventListener("click",(function(){if(S.removeEventListener("click",M),!y.classList.contains("is-active"))return;(0,u.onAuthStateChanged)(v,(function(e){if(e)c=e.uid,l=e.email,(0,d.get)((0,d.child)(m,"users/".concat(c,"queue/queue"))).then((function(e){e.exists()?(h=e.val(),console.log("getQueue",e.val()),p=(0,o.createMovieCards)(h),S.innerHTML=p,S.addEventListener("click",T)):(console.log("No data available"),f=e.val(),console.log("getWatched",e.val()),p="<div><p>ЗАГЛУШКА Queue</p></div>",S.innerHTML=p,S.addEventListener("click",M))})).catch((function(e){console.error(e)}));else{var t=E.getData("queue");p=(0,o.createMovieCards)(t),S.innerHTML=p,S.addEventListener("click",T)}}))})),w=[],(0,u.onAuthStateChanged)(v,(function(e){e?(c=e.uid,l=e.email,(0,d.get)((0,d.child)(m,"users/".concat(c,"watched/watched"))).then((function(e){e.exists()?(w=e.val(),localStorage.setItem("watched",JSON.stringify(w)),console.log("getWatched",e.val()),p=(0,o.createMovieCards)(w),S.innerHTML=p,S.addEventListener("click",M)):(console.log("No data available"),w=e.val(),console.log("getWatched",e.val()),p="<div><p>ЗАГЛУШКА Watched</p></div>",S.innerHTML=p,S.addEventListener("click",M))})).catch((function(e){console.error(e)}))):(w=E.getData("watched"),p=(0,o.createMovieCards)(w),S.innerHTML=p,S.addEventListener("click",M))})),n("dsadE"),n("4smAb"),n("8uW00"),n("j1lrD"),n("4Hwvb");s=n("6Urw1"),d=n("6Nu6u"),u=n("3SEMc");var q,D=n("8uW00"),I=(0,s.initializeApp)({apiKey:"AIzaSyCI5JTbKtHIHNuS4WcbgMfz2S8WxJp_ehM",authDomain:"filmoteka-proj-7.firebaseapp.com",databaseURL:"https://filmoteka-proj-7-default-rtdb.europe-west1.firebasedatabase.app/",projectId:"filmoteka-proj-7",storageBucket:"filmoteka-proj-7.appspot.com",messagingSenderId:"181528100082",appId:"1:181528100082:web:031dd9add36023a4e5e46b",measurementId:"G-1X27T2N03L"}),N=((0,d.getDatabase)(I),(0,u.getAuth)()),W=document.querySelector(".logout"),H=document.querySelector(".welcome-ml");console.log("firebase-ml is running");document.querySelector(".welcome-ml");var A=document.querySelector(".login");(0,u.onAuthStateChanged)(N,(function(e){e?(e.uid,q=e.email,console.log("current user = ",q),W.classList.remove("visually-hidden"),A.classList.add("visually-hidden"),H.innerHTML="Welcome, ".concat(q,"!")):A.classList.remove("visually-hidden")})),D.registrationFormSubmit.addEventListener("click",(function(e){e.preventDefault();var t=D.registrationFormEmail.value;console.log(t);var a=D.registrationFormPassword.value;console.log(a),(0,u.createUserWithEmailAndPassword)(N,t,a).then((function(e){e.user})).catch((function(e){var t=e.code,a=e.message;console.log(t),console.log(a)})),D.registrationForm.reset(),(0,D.closeOnSubmit)()})),D.loginForm.addEventListener("submit",(function(e){e.preventDefault(),localStorage.removeItem("watched"),localStorage.removeItem("queue");var t=D.loginFormEmail.value,a=D.loginFormPassword.value;(0,u.signInWithEmailAndPassword)(N,t,a).then((function(e){e.user;window.location.reload()})).catch((function(e){e.code,e.message})),D.loginForm.reset(),(0,D.closeOnSubmit)()})),W.addEventListener("click",(function(){(0,u.signOut)(N).then((function(){q=null,window.location.reload()})).catch((function(e){console.log(e)}))}))}();
//# sourceMappingURL=mylibrary.21ae9b50.js.map
