var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},a={},o=e.parcelRequire6149;null==o&&((o=function(e){if(e in t)return t[e].exports;if(e in a){var o=a[e];delete a[e];var n={id:e,exports:{}};return t[e]=n,o.call(n.exports,n,n.exports),n.exports}var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){a[e]=t},e.parcelRequire6149=o);var n=o("2ySY5"),i=o("dARph"),r=o("kLGAr");o("fb9GJ");var l=o("25RCP"),s=o("fQ3Fn"),c=o("amyG6");const d=(0,l.initializeApp)({apiKey:"AIzaSyCI5JTbKtHIHNuS4WcbgMfz2S8WxJp_ehM",authDomain:"filmoteka-proj-7.firebaseapp.com",databaseURL:"https://filmoteka-proj-7-default-rtdb.europe-west1.firebasedatabase.app/",projectId:"filmoteka-proj-7",storageBucket:"filmoteka-proj-7.appspot.com",messagingSenderId:"181528100082",appId:"1:181528100082:web:031dd9add36023a4e5e46b",measurementId:"G-1X27T2N03L"}),u=((0,s.getDatabase)(d),(0,s.ref)((0,s.getDatabase)())),g=(0,c.getAuth)();let m,v,h=[],p=[],f="";const L=document.querySelector(".logout"),b=document.querySelector(".welcome-ml");(0,c.onAuthStateChanged)(g,(e=>{e?(m=e.uid,v=e.email,console.log("Это обсервер my-library"),L.classList.remove("visually-hidden"),b.innerHTML=`Welcome, ${v}!`):L.classList.add("visually-hidden")}));const w=document.querySelector(".movies"),S=document.querySelector('[data-id="watched-btn"'),y=document.querySelector('[data-id="queue-btn"'),k=(document.querySelector(".header-nav__link--current-header"),new(0,r.localStorageAPI));function E(e){const t=e.target.closest("li").dataset.id;if("UL"!==e.target.nodeName)try{const e=k.getData("watched"),a=k.getData("genresList"),o=e.filter((({id:e})=>e===Number(t)))[0],{genre_ids:n}=o;let r;n&&(r=a.filter((({id:e})=>n.includes(e))).map((({name:e})=>e))),o.genres=r,k.setData("current-film",o),(0,i.modalBasicLightbox)(o,"watched"),k.addListenersToBtns()}catch(e){console.log(e.message)}}function M(e){const t=e.target.closest("li").dataset.id;if("UL"!==e.target.nodeName)try{const e=k.getData("queue"),a=k.getData("genresList"),o=e.filter((({id:e})=>e===Number(t)))[0],{genre_ids:n}=o;let r;n&&(r=a.filter((({id:e})=>n.includes(e))).map((({name:e})=>e))),o.genres=r,k.setData("current-film",o),(0,i.modalBasicLightbox)(o,"queue"),k.addListenersToBtns()}catch(e){console.log(e.message)}}S.addEventListener("click",(function(){if(w.removeEventListener("click",M),S.classList.contains("is-active"))return;(0,c.onAuthStateChanged)(g,(e=>{e?(m=e.uid,v=e.email,(0,s.get)((0,s.child)(u,`users/${m}watched/watched`)).then((e=>{e.exists()?(h=e.val(),console.log("getWatched",e.val()),f=(0,n.createMovieCards)(h),w.innerHTML=f,w.addEventListener("click",E)):(console.log("No data available"),h=e.val(),console.log("getWatched",e.val()),f="<div><p>ЗАГЛУШКА Watched</p></div>",w.innerHTML=f,w.addEventListener("click",E))})).catch((e=>{console.error(e)}))):(h=k.getData("watched"),f=(0,n.createMovieCards)(h),w.innerHTML=f,w.addEventListener("click",E))}))})),y.addEventListener("click",(function(){if(w.removeEventListener("click",E),!S.classList.contains("is-active"))return;(0,c.onAuthStateChanged)(g,(e=>{if(e)m=e.uid,v=e.email,(0,s.get)((0,s.child)(u,`users/${m}queue/queue`)).then((e=>{e.exists()?(p=e.val(),console.log("getQueue",e.val()),f=(0,n.createMovieCards)(p),w.innerHTML=f,w.addEventListener("click",M)):(console.log("No data available"),h=e.val(),console.log("getWatched",e.val()),f="<div><p>ЗАГЛУШКА Queue</p></div>",w.innerHTML=f,w.addEventListener("click",E))})).catch((e=>{console.error(e)}));else{const e=k.getData("queue");f=(0,n.createMovieCards)(e),w.innerHTML=f,w.addEventListener("click",M)}}))})),function(){let e=[];(0,c.onAuthStateChanged)(g,(t=>{t?(m=t.uid,v=t.email,(0,s.get)((0,s.child)(u,`users/${m}watched/watched`)).then((t=>{t.exists()?(e=t.val(),localStorage.setItem("watched",JSON.stringify(e)),console.log("getWatched",t.val()),f=(0,n.createMovieCards)(e),w.innerHTML=f,w.addEventListener("click",E)):(console.log("No data available"),e=t.val(),console.log("getWatched",t.val()),f="<div><p>ЗАГЛУШКА Watched</p></div>",w.innerHTML=f,w.addEventListener("click",E))})).catch((e=>{console.error(e)}))):(e=k.getData("watched"),f=(0,n.createMovieCards)(e),w.innerHTML=f,w.addEventListener("click",E))}))}(),o("1VOaQ"),o("ioBS9"),o("6pjkE"),o("04jNI"),o("82jod");l=o("25RCP"),s=o("fQ3Fn"),c=o("amyG6");var I=o("6pjkE");const T=(0,l.initializeApp)({apiKey:"AIzaSyCI5JTbKtHIHNuS4WcbgMfz2S8WxJp_ehM",authDomain:"filmoteka-proj-7.firebaseapp.com",databaseURL:"https://filmoteka-proj-7-default-rtdb.europe-west1.firebasedatabase.app/",projectId:"filmoteka-proj-7",storageBucket:"filmoteka-proj-7.appspot.com",messagingSenderId:"181528100082",appId:"1:181528100082:web:031dd9add36023a4e5e46b",measurementId:"G-1X27T2N03L"}),q=((0,s.getDatabase)(T),(0,c.getAuth)()),D=document.querySelector(".logout"),A=document.querySelector(".welcome-ml");let C,H;console.log("firebase-ml is running");document.querySelector(".welcome-ml");const N=document.querySelector(".login");(0,c.onAuthStateChanged)(q,(e=>{e?(C=e.uid,H=e.email,console.log("current user = ",H),D.classList.remove("visually-hidden"),N.classList.add("visually-hidden"),A.innerHTML=`Welcome, ${H}!`):N.classList.remove("visually-hidden")})),I.registrationFormSubmit.addEventListener("click",(function(e){e.preventDefault();const t=I.registrationFormEmail.value;console.log(t);const a=I.registrationFormPassword.value;console.log(a),(0,c.createUserWithEmailAndPassword)(q,t,a).then((e=>{e.user})).catch((e=>{const t=e.code,a=e.message;console.log(t),console.log(a)})),I.registrationForm.reset(),(0,I.closeOnSubmit)()})),I.loginForm.addEventListener("submit",(function(e){e.preventDefault(),localStorage.removeItem("watched"),localStorage.removeItem("queue");const t=I.loginFormEmail.value,a=I.loginFormPassword.value;(0,c.signInWithEmailAndPassword)(q,t,a).then((e=>{e.user;window.location.reload()})).catch((e=>{e.code,e.message})),I.loginForm.reset(),(0,I.closeOnSubmit)()})),D.addEventListener("click",(function(){(0,c.signOut)(q).then((()=>{H=null,window.location.reload()})).catch((e=>{console.log(e)}))}));
//# sourceMappingURL=mylibrary.e37962bd.js.map
