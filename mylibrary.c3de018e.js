var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},a={},n=e.parcelRequire6149;null==n&&((n=function(e){if(e in t)return t[e].exports;if(e in a){var n=a[e];delete a[e];var i={id:e,exports:{}};return t[e]=i,n.call(i.exports,i,i.exports),i.exports}var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(e,t){a[e]=t},e.parcelRequire6149=n);var i=n("2ySY5"),o=n("dARph"),l=n("kLGAr");n("fb9GJ");var r=n("25RCP"),s=n("fQ3Fn"),c=n("amyG6");const d=(0,r.initializeApp)({apiKey:"AIzaSyCI5JTbKtHIHNuS4WcbgMfz2S8WxJp_ehM",authDomain:"filmoteka-proj-7.firebaseapp.com",databaseURL:"https://filmoteka-proj-7-default-rtdb.europe-west1.firebasedatabase.app/",projectId:"filmoteka-proj-7",storageBucket:"filmoteka-proj-7.appspot.com",messagingSenderId:"181528100082",appId:"1:181528100082:web:031dd9add36023a4e5e46b",measurementId:"G-1X27T2N03L"}),u=((0,s.getDatabase)(d),(0,s.ref)((0,s.getDatabase)())),g=(0,c.getAuth)();let m,p,h=[],v=[];const f=document.querySelector("#logout-ml"),L=document.querySelector(".welcome-ml");(0,c.onAuthStateChanged)(g,(e=>{e?(m=e.uid,p=e.email,console.log("Это обсервер my-library"),f.classList.remove("visually-hidden"),L.innerHTML=`Welcome, ${p}!`):f.classList.add("visually-hidden")}));const b=document.querySelector(".movies"),k=document.querySelector('[data-id="watched-btn"'),y=document.querySelector('[data-id="queue-btn"'),S=(document.querySelector(".header-nav__link--current-header"),new(0,l.localStorageAPI));function w(e){const t=e.target.closest("li").dataset.id;if("UL"!==e.target.nodeName)try{const e=S.getData("watched"),a=S.getData("genresList"),n=e.filter((({id:e})=>e===Number(t)))[0],{genre_ids:i}=n;let l;i&&(l=a.filter((({id:e})=>i.includes(e))).map((({name:e})=>e))),n.genres=l,S.setData("current-film",n),(0,o.modalBasicLightbox)(n,"watched"),S.addListenersToBtns()}catch(e){console.log(e.message)}}function M(e){const t=e.target.closest("li").dataset.id;if("UL"!==e.target.nodeName)try{const e=S.getData("queue"),a=S.getData("genresList"),n=e.filter((({id:e})=>e===Number(t)))[0],{genre_ids:i}=n;let l;i&&(l=a.filter((({id:e})=>i.includes(e))).map((({name:e})=>e))),n.genres=l,S.setData("current-film",n),(0,o.modalBasicLightbox)(n,"queue"),S.addListenersToBtns()}catch(e){console.log(e.message)}}k.addEventListener("click",(function(){let e="";if(b.removeEventListener("click",M),k.classList.contains("is-active"))return;(0,c.onAuthStateChanged)(g,(t=>{if(t)m=t.uid,p=t.email,(0,s.get)((0,s.child)(u,`users/${m}watched/watched`)).then((t=>{t.exists()?(h=t.val(),console.log("getWatched",t.val()),e=(0,i.createMovieCards)(h),b.innerHTML=e,b.addEventListener("click",w)):(console.log("No data available"),h=t.val(),console.log("getWatched",t.val()),e="<div><p>ЗАГЛУШКА Watched</p></div>",b.innerHTML=e,b.addEventListener("click",w))})).catch((e=>{console.error(e)}));else{h=S.getData("watched");const e=(0,i.createMovieCards)(h);b.innerHTML=e,b.addEventListener("click",w)}}))})),y.addEventListener("click",(function(){if(b.removeEventListener("click",w),!k.classList.contains("is-active"))return;(0,c.onAuthStateChanged)(g,(e=>{if(e)m=e.uid,p=e.email,(0,s.get)((0,s.child)(u,`users/${m}queue/queue`)).then((e=>{if(e.exists()){v=e.val(),console.log("getQueue",e.val());const t=(0,i.createMovieCards)(v);b.innerHTML=t,b.addEventListener("click",M)}else console.log("No data available"),h=e.val(),console.log("getWatched",e.val()),markup="<div><p>ЗАГЛУШКА Queue</p></div>",b.innerHTML=markup,b.addEventListener("click",w)})).catch((e=>{console.error(e)}));else{const e=S.getData("queue"),t=(0,i.createMovieCards)(e);b.innerHTML=t,b.addEventListener("click",M)}}))})),function(){let e=[];(0,c.onAuthStateChanged)(g,(t=>{if(t)m=t.uid,p=t.email,(0,s.get)((0,s.child)(u,`users/${m}watched/watched`)).then((t=>{if(t.exists()){e=t.val(),localStorage.setItem("watched",JSON.stringify(e)),console.log("getWatched",t.val());const a=(0,i.createMovieCards)(e);b.innerHTML=a,b.addEventListener("click",w)}else console.log("No data available"),e=t.val(),console.log("getWatched",t.val()),markup="<div><p>ЗАГЛУШКА Watched</p></div>",b.innerHTML=markup,b.addEventListener("click",w)})).catch((e=>{console.error(e)}));else{e=S.getData("watched");const t=(0,i.createMovieCards)(e);b.innerHTML=t,b.addEventListener("click",w)}}))}(),n("1VOaQ"),n("ioBS9"),n("04jNI"),n("82jod");r=n("25RCP"),s=n("fQ3Fn"),c=n("amyG6");const T=(0,r.initializeApp)({apiKey:"AIzaSyCI5JTbKtHIHNuS4WcbgMfz2S8WxJp_ehM",authDomain:"filmoteka-proj-7.firebaseapp.com",databaseURL:"https://filmoteka-proj-7-default-rtdb.europe-west1.firebasedatabase.app/",projectId:"filmoteka-proj-7",storageBucket:"filmoteka-proj-7.appspot.com",messagingSenderId:"181528100082",appId:"1:181528100082:web:031dd9add36023a4e5e46b",measurementId:"G-1X27T2N03L"}),I=((0,s.getDatabase)(T),(0,c.getAuth)()),q=document.querySelector("#logout-ml"),C=document.querySelector(".welcome-ml");let D,E;(0,c.onAuthStateChanged)(I,(e=>{e?(D=e.uid,E=e.email,console.log("current user = ",E),q.classList.remove("visually-hidden"),C.innerHTML=`Welcome, ${E}!`):q.classList.add("visually-hidden")})),q.addEventListener("click",(function(){(0,c.signOut)(I).then((()=>{E=null,window.location.reload()})).catch((e=>{console.log(e)}))}));
//# sourceMappingURL=mylibrary.c3de018e.js.map
