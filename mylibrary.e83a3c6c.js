!function(){var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},a={},n=e.parcelRequire6149;null==n&&((n=function(e){if(e in t)return t[e].exports;if(e in a){var n=a[e];delete a[e];var i={id:e,exports:{}};return t[e]=i,n.call(i.exports,i,i.exports),i.exports}var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(e,t){a[e]=t},e.parcelRequire6149=n);var i=n("aTzrc"),o=n("g2YN6"),r=n("6fJbC");n("1VFfL");var c,d,l=n("6Urw1"),s=n("6Nu6u"),u=n("3SEMc"),g=(0,l.initializeApp)({apiKey:"AIzaSyCI5JTbKtHIHNuS4WcbgMfz2S8WxJp_ehM",authDomain:"filmoteka-proj-7.firebaseapp.com",databaseURL:"https://filmoteka-proj-7-default-rtdb.europe-west1.firebasedatabase.app/",projectId:"filmoteka-proj-7",storageBucket:"filmoteka-proj-7.appspot.com",messagingSenderId:"181528100082",appId:"1:181528100082:web:031dd9add36023a4e5e46b",measurementId:"G-1X27T2N03L"}),f=((0,s.getDatabase)(g),(0,s.ref)((0,s.getDatabase)())),v=(0,u.getAuth)(),m=document.querySelector("#logout-ml"),h=document.querySelector(".welcome-ml");(0,u.onAuthStateChanged)(v,(function(e){e?(c=e.uid,d=e.email,console.log("Это обсервер my-library"),m.classList.remove("visually-hidden"),h.innerHTML="Welcome, ".concat(d,"!")):m.classList.add("visually-hidden")}));var p=document.querySelector(".movies"),L=document.querySelector('[data-id="watched-btn"'),b=document.querySelector('[data-id="queue-btn"'),k=(document.querySelector(".header-nav__link--current-header"),new(0,r.localStorageAPI));function w(e){var t=e.target.closest("li").dataset.id;if("UL"!==e.target.nodeName)try{var a,n=k.getData("watched"),i=k.getData("genresList"),r=n.filter((function(e){return e.id===Number(t)}))[0],c=r.genre_ids;c&&(a=i.filter((function(e){var t=e.id;return c.includes(t)})).map((function(e){return e.name}))),r.genres=a,k.setData("current-film",r),(0,o.modalBasicLightbox)(r,"watched"),k.addListenersToBtns()}catch(e){console.log(e.message)}}function S(e){var t=e.target.closest("li").dataset.id;if("UL"!==e.target.nodeName)try{var a,n=k.getData("queue"),i=k.getData("genresList"),r=n.filter((function(e){return e.id===Number(t)}))[0],c=r.genre_ids;c&&(a=i.filter((function(e){var t=e.id;return c.includes(t)})).map((function(e){return e.name}))),r.genres=a,k.setData("current-film",r),(0,o.modalBasicLightbox)(r,"queue"),k.addListenersToBtns()}catch(e){console.log(e.message)}}L.addEventListener("click",(function(){var e="";if(p.removeEventListener("click",S),L.classList.contains("is-active"))return;(0,u.onAuthStateChanged)(v,(function(t){if(t)c=t.uid,d=t.email,(0,s.get)((0,s.child)(f,"users/".concat(c,"watched/watched"))).then((function(t){t.exists()?(getWatched=t.val(),console.log("getWatched",t.val()),e=(0,i.createMovieCards)(getWatched),p.innerHTML=e,p.addEventListener("click",w)):(console.log("No data available"),getWatched=t.val(),console.log("getWatched",t.val()),e="<div><p>ЗАГЛУШКА Watched</p></div>",p.innerHTML=e,p.addEventListener("click",w))})).catch((function(e){console.error(e)}));else{getWatched=k.getData("watched");var a=(0,i.createMovieCards)(getWatched);p.innerHTML=a,p.addEventListener("click",w)}}))})),b.addEventListener("click",(function(){if(p.removeEventListener("click",w),!L.classList.contains("is-active"))return;(0,u.onAuthStateChanged)(v,(function(e){if(e)c=e.uid,d=e.email,(0,s.get)((0,s.child)(f,"users/".concat(c,"queue/queue"))).then((function(e){if(e.exists()){getQueue=e.val(),console.log("getQueue",e.val());var t=(0,i.createMovieCards)(getQueue);p.innerHTML=t,p.addEventListener("click",S)}else console.log("No data available"),getWatched=e.val(),console.log("getWatched",e.val()),markup="<div><p>ЗАГЛУШКА Queue</p></div>",p.innerHTML=markup,p.addEventListener("click",w)})).catch((function(e){console.error(e)}));else{var t=k.getData("queue"),a=(0,i.createMovieCards)(t);p.innerHTML=a,p.addEventListener("click",S)}}))})),function(){var e=[];(0,u.onAuthStateChanged)(v,(function(t){if(t)c=t.uid,d=t.email,(0,s.get)((0,s.child)(f,"users/".concat(c,"watched/watched"))).then((function(t){if(t.exists()){e=t.val(),localStorage.setItem("watched",JSON.stringify(e)),console.log("getWatched",t.val());var a=(0,i.createMovieCards)(e);p.innerHTML=a,p.addEventListener("click",w)}else console.log("No data available"),e=t.val(),console.log("getWatched",t.val()),markup="<div><p>ЗАГЛУШКА Watched</p></div>",p.innerHTML=markup,p.addEventListener("click",w)})).catch((function(e){console.error(e)}));else{e=k.getData("watched");var a=(0,i.createMovieCards)(e);p.innerHTML=a,p.addEventListener("click",w)}}))}(),n("dsadE"),n("4smAb"),n("j1lrD"),n("4Hwvb");l=n("6Urw1"),s=n("6Nu6u"),u=n("3SEMc");var y,M=(0,l.initializeApp)({apiKey:"AIzaSyCI5JTbKtHIHNuS4WcbgMfz2S8WxJp_ehM",authDomain:"filmoteka-proj-7.firebaseapp.com",databaseURL:"https://filmoteka-proj-7-default-rtdb.europe-west1.firebasedatabase.app/",projectId:"filmoteka-proj-7",storageBucket:"filmoteka-proj-7.appspot.com",messagingSenderId:"181528100082",appId:"1:181528100082:web:031dd9add36023a4e5e46b",measurementId:"G-1X27T2N03L"}),T=((0,s.getDatabase)(M),(0,u.getAuth)()),E=document.querySelector("#logout-ml"),W=document.querySelector(".welcome-ml");(0,u.onAuthStateChanged)(T,(function(e){e?(e.uid,y=e.email,console.log("current user = ",y),E.classList.remove("visually-hidden"),W.innerHTML="Welcome, ".concat(y,"!")):E.classList.add("visually-hidden")})),E.addEventListener("click",(function(){(0,u.signOut)(T).then((function(){y=null,window.location.reload()})).catch((function(e){console.log(e)}))}))}();
//# sourceMappingURL=mylibrary.e83a3c6c.js.map
